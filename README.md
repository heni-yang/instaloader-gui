# Instagram Crawling, Classification, and Upscaling Project

이 프로젝트는 인스타그램 이미지 크롤링, 이미지 분류(주로 인물 및 비인물 구분), 그리고 업스케일링(이미지 해상도 향상)을 위한 통합 솔루션입니다.  
사용자 친화적인 GUI를 제공하여 계정 관리, 검색 옵션 설정, 다운로드 경로 지정 및 후처리(분류/업스케일링) 작업을 쉽게 수행할 수 있습니다.

---

## 🚀 주요 기능

### 📥 크롤링 기능
- **해시태그/사용자 ID 기반** 이미지 및 영상 다운로드
- **Instaloader 라이브러리** 활용
- **Firefox 쿠키 기반** 세션 관리 및 로그인
- **요청 간 대기시간 설정** (기본 자동 + 수동 추가 대기)
- **프로필 관리**: 존재하지 않는 프로필, 비공개 프로필 자동 관리
- **자동 검색 목록 정리**: 완료된 항목 자동 제거

### 🎯 이미지 분류
- **YOLO 기반 모델**로 인물, 얼굴, 몸통 검출
- **인물/비인물 자동 분류**
- **실시간 진행률 표시**
- **깔끔한 로그 출력**: 이모지 제거로 일관된 텍스트 서식

### 🔍 업스케일링
- **GFPGAN + Real-ESRGAN** 모델 결합
- **얼굴 복원** 및 **전체 이미지 해상도 향상**
- **자동 모델 다운로드**

### 🖥️ GUI 인터페이스
- **직관적인 Tkinter 기반 GUI**
- **계정 관리** (추가/삭제/세션 관리)
- **검색 옵션 설정** (해시태그/사용자 ID)
- **다운로드 경로 관리**
- **실시간 진행률 및 상태 모니터링**
- **개선된 UX**: 드롭다운 정렬, 일관된 레이아웃, 스크롤바 통일

---

## 📁 프로젝트 구조

```plaintext
프로젝트 루트/
├── run_project.bat                   # 실행 배치 파일
├── requirements/
│   ├── requirements_classify.txt     # 분류/업스케일링 의존성
│   └── requirements_insta.txt        # 인스타그램 크롤링 의존성
├── src/
│   ├── main.py                       # GUI 진입점
│   ├── core/
│   │   ├── downloader.py             # 인스타그램 크롤링 모듈
│   │   └── profile_manager.py        # 프로필 관리 모듈
│   ├── gui/
│   │   ├── main_window.py            # 메인 GUI 창 (모듈화된 구조)
│   │   ├── components/
│   │   │   ├── account_panel.py      # 계정 관리 패널
│   │   │   ├── search_panel.py       # 검색 설정 패널
│   │   │   ├── progress_panel.py     # 진행률 표시 패널
│   │   │   └── status_panel.py       # 상태 로그 패널
│   │   ├── controllers/
│   │   │   └── gui_controller.py     # GUI 컨트롤러
│   │   ├── handlers/
│   │   │   └── queue_handler.py      # GUI 이벤트 핸들러
│   │   └── dialogs/
│   │       ├── settings.py           # 설정 관련 다이얼로그
│   │       ├── account_management.py # 계정 관리 다이얼로그
│   │       └── profile_manager.py    # 프로필 관리 다이얼로그
│   ├── processing/
│   │   ├── post_processing.py        # 분류 및 업스케일링 제어
│   │   ├── classifier.py             # YOLO 분류 래퍼
│   │   ├── yolo/
│   │   │   └── classify_yolo.py      # YOLO 분류 모듈
│   │   └── upscaler/
│   │       └── upscaler.py           # 업스케일링 모듈
│   └── utils/
│       ├── config.py                 # 설정 파일 관리
│       ├── environment.py            # 환경 설정
│       ├── file_utils.py             # 파일 유틸리티
│       └── logger.py                 # 로깅 유틸리티
├── data/
│   ├── config/                       # 설정 파일 저장소
│   ├── downloads/                    # 다운로드 파일 저장소
│   ├── logs/                         # 로그 파일 저장소
│   └── sessions/                     # 세션 파일 저장소
├── models/
│   ├── classification/               # YOLO 분류 모델
│   │   ├── yolo11l-seg.pt           # 세그멘테이션 모델
│   │   └── yolo11x-pose.pt          # 포즈 추정 모델
│   └── upscaling/                    # 업스케일링 모델 (자동 다운로드)
├── venv/
│   ├── classify_venv/                # 분류/업스케일링 가상환경
│   └── insta_venv/                   # 인스타그램 크롤링 가상환경
└── docs/                             # 문서 저장소
```

---

## 🛠️ 설치 및 설정

### 🚀 빠른 시작 (권장)

1. **사전 준비 사항**:
   - Python 3.10 이상 설치
   - Git 클론:
     ```bash
     git clone https://github.com/heni-yang/instaloader-gui.git
     cd instaloader-gui
     ```

2. **자동 설치**:
   ```bash
   # Windows
   run_project.bat
   
   # 또는 직접 실행
   python -m src.main
   ```

   > **참고**: `run_project.bat`이 자동으로 다음 작업을 수행합니다:
   > - 가상환경 생성 및 활성화
   > - 필요한 의존성 설치
   > - 모델 파일 자동 다운로드
   > - GUI 실행

### 🔧 수동 설치 (고급 사용자)

세부적인 제어가 필요한 경우 수동으로 설치할 수 있습니다.

#### 1. 가상환경 생성
```bash
python -m venv venv/insta_venv
python -m venv venv/classify_venv
```

#### 2. 인스타그램 크롤링 의존성
```bash
venv/insta_venv/Scripts/activate
pip install -r requirements/requirements_insta.txt
```

#### 3. 분류/업스케일링 의존성
```bash
venv/classify_venv/Scripts/activate
pip install -r requirements/requirements_classify.txt
```

#### 4. 모델 파일
- **분류 모델**: `models/classification/` 폴더에 YOLO 모델 파일 배치
- **업스케일링 모델**: `models/upscaling/` 폴더에 GFPGAN, RealESRGAN 모델 배치
- **자동 다운로드**: 모델 파일이 없으면 자동으로 다운로드 시도

---

## 🖥️ GUI 사용법

### 1. 프로그램 실행

```bash
# 배치 파일 사용 (권장)
run_project.bat

# 또는 직접 실행
python -m src.main
```

### 2. 계정 관리

#### 계정 추가
1. **"계정 추가"** 버튼 클릭
2. **인스타그램 사용자명**과 **비밀번호** 입력
3. **"저장"** 버튼으로 계정 등록

#### 계정 삭제
1. **계정 목록**에서 삭제할 계정 선택
2. **"계정 삭제"** 버튼 클릭
3. **세션 파일도 함께 삭제**할지 선택

### 3. 검색 설정

#### 검색 유형 선택
- **해시태그**: 특정 해시태그가 포함된 게시물 검색
- **사용자 ID**: 특정 사용자의 게시물 검색
- **상태 유지**: 검색 유형 변경 시 하위 체크박스 상태 보존

#### 검색 옵션 설정
- **이미지 다운로드**: 체크 시 이미지 파일 다운로드
- **영상 다운로드**: 체크 시 영상 파일 다운로드 (해시태그만)
- **릴스 다운로드**: 체크 시 릴스 다운로드 (사용자 ID만)
- **인물 분류**: 체크 시 다운로드 후 자동 인물/비인물 분류
- **업스케일링**: 체크 시 인물 분류 후 자동 업스케일링

#### 요청 간 대기시간
- **0초**: Instaloader 자동 제어 (권장)
- **1초 이상**: 자동 제어 + 설정한 시간만큼 추가 대기

### 4. 검색어 입력

#### 해시태그 검색
```
# 여러 해시태그 입력 (개행 또는 쉼표로 구분)
beauty
fashion
makeup
```

#### 사용자 ID 검색
```
# 여러 사용자 ID 입력 (개행 또는 쉼표로 구분)
username1
username2
username3
```

### 5. 다운로드 경로 설정

1. **"경로 선택"** 버튼으로 다운로드 폴더 지정
2. **"폴더 열기"** 버튼으로 현재 경로 확인
3. **게시물 수 설정**: 0 = 전체 다운로드

### 6. 다운로드된 프로필 관리

#### 프로필 목록
- **해시태그 목록**: 다운로드된 해시태그 프로필들
- **사용자 ID 목록**: 다운로드된 사용자 프로필들

#### 프로필 추가
- **"선택된 해시태그/사용자 ID 추가"**: 선택한 프로필을 검색 목록에 추가
- **"모든 해시태그/사용자 ID 추가"**: 모든 프로필을 검색 목록에 추가

#### 정렬 기능 (드롭다운)
- **생성일 내림차순**: 디렉토리 생성일 기준 내림차순
- **생성일 오름차순**: 디렉토리 생성일 기준 오름차순
- **INI 내림차순**: INI 파일 timestamp 기준 내림차순
- **INI 오름차순**: INI 파일 timestamp 기준 오름차순

#### 프로필 관리
- **"프로필 관리"** 버튼: 존재하지 않는 프로필, 비공개 프로필 관리
- **"선택된 대상 삭제"**: 선택한 프로필과 관련 디렉토리 삭제

### 7. 후처리 기능

#### 이미지 분류
- **"선택된 이미지 분류"**: 선택한 프로필의 이미지만 분류
- **"분류된 이미지 재분류"**: 이미 분류된 이미지 재분류

#### 새로고침
- **"새로 고침"** 버튼: 프로필 목록 업데이트

### 8. 크롤링 실행

1. **"크롤링 시작"** 버튼 클릭
2. **진행률 확인**: 실시간 진행률 및 예상 완료 시간 표시
3. **상태 모니터링**: 상태 창에서 상세 로그 확인
4. **중지**: **"중지"** 버튼으로 언제든지 중단 가능

---

## 📊 진행률 및 상태 모니터링

### 진행률 표시
- **전체 진행률**: 전체 작업 대비 현재 진행률
- **예상 완료 시간**: 현재 속도 기준 예상 완료 시점
- **현재 작업**: 현재 처리 중인 프로필 정보

### 상태 메시지 (깔끔한 텍스트 서식)
- **실시간 로그**: 다운로드, 분류, 업스케일링 진행 상황
- **오류 메시지**: 문제 발생 시 상세 오류 정보
- **완료 알림**: 각 단계별 완료 메시지
- **자동 정리**: 완료된 항목 자동 검색 목록 제거

---

## 🔧 고급 설정

### 프로필 관리

#### 존재하지 않는 프로필
- 크롤링 중 발견된 존재하지 않는 프로필 자동 저장
- **프로필 관리** → **존재하지 않는 프로필** 탭에서 관리
- 목록에서 제거 시 다시 크롤링 가능

#### 비공개 프로필
- "Private but not followed" 오류 발생 시 자동 저장
- **프로필 관리** → **비공개 프로필** 탭에서 관리
- 팔로우 후 목록에서 제거 가능

### 요청 간 대기시간 설정

#### 권장 설정
- **0초**: Instaloader 자동 제어 (대부분의 경우 권장)
- **1-3초**: 안정적인 크롤링을 위한 추가 대기
- **5초 이상**: 매우 보수적인 크롤링

#### 동작 방식
- **0초**: Instaloader가 자동으로 최적의 대기시간 계산
- **1초 이상**: 자동 대기시간 + 설정한 시간만큼 추가 대기

---

## 🐛 문제 해결

### 일반적인 문제

#### 로그인 실패
- **Firefox 쿠키 확인**: Firefox에서 인스타그램 로그인 상태 확인
- **비밀번호 확인**: 정확한 비밀번호 입력
- **이중 인증**: 이중 인증이 활성화된 경우 비활성화 후 시도

#### 다운로드 실패
- **네트워크 연결**: 인터넷 연결 상태 확인
- **계정 상태**: 계정이 차단되지 않았는지 확인
- **요청 간 대기시간**: 너무 빠른 요청으로 인한 차단 가능성

#### 분류/업스케일링 실패
- **모델 파일**: 필요한 모델 파일이 올바른 위치에 있는지 확인
- **가상환경**: 올바른 가상환경이 활성화되었는지 확인
- **메모리**: 충분한 메모리 확보

### 로그 확인
- **상태 창**: GUI의 상태 창에서 실시간 로그 확인
- **로그 파일**: `data/logs/` 폴더의 로그 파일 확인

---

## 📝 라이선스 및 참고

- **Instaloader**: MIT License
- **YOLO**: AGPL-3.0 License
- **GFPGAN**: Apache 2.0 License
- **Real-ESRGAN**: BSD 3-Clause License

---

## 🤝 기여하기

1. **Fork** the repository
2. **Create** a feature branch (`git checkout -b feature/AmazingFeature`)
3. **Commit** your changes (`git commit -m 'Add some AmazingFeature'`)
4. **Push** to the branch (`git push origin feature/AmazingFeature`)
5. **Open** a Pull Request

---

## 📞 지원

문제가 발생하거나 질문이 있으시면:
1. **Issues** 탭에서 새로운 이슈 생성
2. **상세한 오류 메시지**와 **재현 단계** 포함
3. **시스템 정보** (OS, Python 버전 등) 제공


